<?php
/**
 * D:\00_WP\xampp\htdocs\0\wp-content\themes\kasax_child\inc\core\SystemConfig.php
 * // どこからでもアクセス可能
 * // $settings = KxSu::get('display_colors_css');
 * // echo $settings->get('css_color_type'); // "d"
 */

namespace Kx\Core; // 1. 名前空間の定義

class SystemConfig {

    private static $instance = null;
    private static $settings = [];
    private static $paths = [];

    private $on_off =
        [
            'epub_ex' => 0,//Kindle_epub 1がON。EPUB用
        ];

    private $display_colors_css = 'd';

    private $export_text = [
        'map' => [

            292391 => 10102,
            //300072 => 10102,

            292357 => 10232,
            292323 => 10232,
            292684 => 10232,
            300518 => 10232,
            300412 => 10232,

            294734 => 10104,//作家手法
            300928 => 10104,//作家手法+パターン

            /*
            //298038 => 10104,
            //291847 => 10104,

            292021 => 103,

            293103 => 103,

            297520 => 103,

            */

            310416 => 'simple_join',
            310414 => 'simple_join',
        ],

        'exclude_ids' => [11181, 11182,11271,300722],
        'important' => [
            '1st' => [10],
            '2nd' => [20,24,29,1118,1127,1128,1129,],
        ],
    ];


    private $post_id = [
            'γ≫芸術・作品' => 2370,
            'σ≫芸術・作品' => 8125,
            'δ≫芸術・作品' => 31770,
    ];
    private $base_preg = [
            'date_s'     => '(-?\d{1,4})(年|\/)(\d{1,2}|)(月|\/|)(\d{1,2}|)',
            'Db_date_on' => '/wp_kx_shared_title|wp_kx_works/',
            'timestamp'  => '/20(\d{2})(_|-)(\d{2})(_|-)(\d{2})/',
    ];

    private $DBshare_title1_column = [
        'Β' => 'id_lesson',
            'γ' => 'id_sens',
            'σ' => 'id_study',
            'δ' => 'id_data',
    ];


    private $DBshare_column_name = [
            'id_lesson' => '資料',
            'id_sens' => '感想',
            'id_study' => '研究',
            'id_data' => '教訓',
    ];

    private $DBjson_pickup = [
            'kx_1'       => ['タグ', '概要', 'ShortCODE', 'GhostON', 'BaseID','consolidated_to','consolidated_ids','consolidated_from'],
            'ShareTitle' => ['タグ','概要'],
            'Works'      => ['シリーズ', 'スタジオ', '監督', '原作者', '脚本', '演出', 'キャラクター原案', 'キャラクターデザイン', '音楽', 'キャラ', '属性', 'ジャンル', '評価','概要'],
            //'Create'     => ['ids'], //* 不採用。2025-04-11。あまり速度変わらず。
    ];



    private $title_array =
    [
        'works'           =>	'/^∬(\d{1,})≫c(\d\w{1,}\d)≫((ksy|olf|ygs|pnm|sys)(\d{1,}))/' ,
        'character'       =>	'/^∬(\d{1,})≫c(\d\w{1,}\d)/' ,
        'taijin'          =>	'/^∬(\d{1,})≫c(\d\w{1,}\d)≫＼c(\d\w{1,}\d)/' ,
        'create'          =>	'/^∬(\d{1,})/' ,
        'Shared'       		=>	'/^(Β|γ|σ|δ)/',
        'Shared_works'    =>	'/^(γ|σ|δ)≫(芸術・作品|人物)≫list≫/i',
    ];


    private $title_preg =
    [
        '1920'               => '/∬\d{1,}.*((ksy|olf|ygs|pnm|sys).*≫来歴|≫来歴≫共通w)/i' , //来歴$|
        'SharedTitleDB'  		 =>	'/^(Β|γ|σ|δ)≫/' ,
        'worksDB'   				 =>	'/^(γ|σ|δ)≫(芸術・作品|人物)≫list≫/i' ,
        //'worksCREATE' 			 =>	'/^((∬\d{1,})≫([^≫]+))/' ,//* 不採用。2025-04-11。あまり速度変わらず。
        //'worksCREATE2' 			 =>	'/^∬\d{1,}≫c/' ,//* 不採用。2025-04-11。あまり速度変わらず。

        'array_add_category' => //自動追記カテゴリーpublic $kxst_add_category =
        [
            '作品'					 =>['/∬\w{1,}/'     ],
            'キャラクター1'	 =>['/∬\w{1,}≫c/'  ],
        ],

        'array_add_tag'    => //public $kxst_add_tag =* 自動追記タグ
        [
            'キャラクター1'	=>[ '/∬\w{1,}≫c\d\w{1,}\d/' , '/c\d\w{1,}\d/' ],
            '∮作品Idea'	   =>[ '/∮≫S\d{4}/'            , '/S\d{4}/' ],
            //'作品'					=>['/∬.*(ygs|ksy|olf|sys)\d{3,}/i'  , '/(ygs|ksy|olf|sys)\d{3,}/i'],
        ],
    ];

    //KxSu::get('titile_search');
    private $titile_search = //public $kxtt_title_array =[];//2023年型//public $search = //* 設定：基本検索
    [
        'work_Platform'            => 'ksy|olf|ygs|pnm|sys',
        'work_template_short'      =>	'(A|B|K|Y)',
        'SharedTitleDB'  					 =>	'^(Β|γ|σ|δ)' ,
        'kx_0_ft'  								 =>	'^(∫|∮|∬\d{1,}≫1構成≫設定)' ,
        'kx_0_DB'  								 =>	'^(∫|∮|Β|γ|∬\d{1,}≫1構成≫設定)' ,
        'kx_1'  								   =>	'^δ≫(芸術・作品|人物)≫list≫' ,
        'worksDB'   							 =>	'^(γ|σ|δ)≫(芸術・作品|人物)≫list≫' ,
    ];


    //public $title_head =
    private $title_head =
    [
        '/^(Β|γ|σ|δ)$/' =>
        [
            '国・地域'          => [ 2 ] ,
            '芸術・制作'        => [ 1 , 'name' => [ '分類' => 2 ] ],
            '芸術・作品'        => [ 1 , 'name' => [ '分類' => 2 ] ],
        ],

        '/^∬.*$/' =>
        [
            '∬'  => 'on'
        ],
    ];



    //public $kx10_add_title  =* kx10。タイトル追記
    private $title_kx10 =
    [
        '0' => 'if❌',
        '1' => '世界',
        '2' => '起点',
        '3' => '現状',
        '4' => '展望・未来',
        '5' => '終焉・オチ',
        '6' => '❌未使用❌',
        '7' => '追記',
        '8' => '称賛（第三者視点）',
        '9' => 'その他（視点自由）',
        '〇h111' => 'ズレⅠ',
        '〇h112' => 'ズレⅡ',
        '〇p112' => 'ズレⅡ',
        '〇w501' => '主感情Ⅰ',
        '〇w502' => '主感情Ⅱ',
        '〇p152' => '主感情Ⅱ',
    ];




    //public $kx30_number  =
    private $title_kx30 =
    [
        '/∬/'	=>
        [
            'a321ygs'	=>[ '認知ⅠY'	],	//a32
            'a321ksy'	=>[ '認知ⅠK'	],	//a33
            'a321olf'	=>[ '認知ⅠO'	],	//a33
            'a341ygs'	=>[ '信頼ⅠY'	],	//a32
            'a341ksy'	=>[ '信頼ⅠK'	],	//a33
            'a341olf'	=>[ '信頼ⅠO'	],	//a33

            'a502'		=>[ '配役＋状況' ],
            'a911'		=>[ '演出Ⅰ'		 ] ,

            'b111'		=>[ '軸/核ⅠA'	],
            'b311ksy'	=>[ '軸/核ⅠK'	],
            'b311ygs'	=>[ '軸/核ⅠY'	],

            //cは使用禁止。キャラと誤認

            'f002'		=>[ '人格' ],

            'f212'		=>[ '称賛'  			],
            'f312'		=>[ '弱点'	 			],

            'h111'		=>[ 'ズレⅠ'  ],
            'h112ksy'	=>[ 'ズレK'   ],
            'h112olf'	=>[ 'ズレO'	 ],
            'h112ygs'	=>[ 'ズレY'	 ],
            'h113'		=>[ 'ズレⅲ' ],
            'h117'		=>[ 'ズレB' ],

            //'p151'		=>[ '主感情Ⅰ'		],
            'p152'		=>[ '主感情Ⅱ'		],

            'w501'		=>[ '主感情Ⅰ'		],	//g91
            'w502'		=>[ '主感情Ⅱ'		],	//g90
            'w503'		=>[ '主感情ⅲ'		],	//w913
            'w507'		=>[ '主感情Ⅱb'		],

            'w581'		=>[ '発見AⅠ'				],//ｆ712
            'w582'		=>[ '発見AⅡ'				],//ｆ712
            'w583'		=>[ '開放Aⅲ'				],//ｆ712
            'w587'		=>[ '発見AⅡB'				],

            'w591'		=>[ '発見BⅠ'				],//ｆ712
            'w592'		=>[ '発見BⅡ'				],//ｆ712
            'w593'		=>[ '発見Bⅲ'				],//ｆ712
            'w597'		=>[ '発見BⅡb'				],

            'y011'		=>[ '視点ⅰ'									],	//g70
        ],

        /*
        '/∬.*脚本≫〇/'	=>
        [
            '-9'		=>[ '謎・起点ⅱ'										] ,
            '-4'		=>[ '解答・-4ⅱ'										] ,
            '-3'		=>[ '解答・-3ⅱ'										] ,
            '-2'		=>[ '解答・-2ⅱ'										] ,
            '-1'		=>[ '解答・-1ⅱ'										] ,
            '-0'		=>[ '解答・-0ⅱ'										] ,
        ],
        */

        '/κ/'	=>
        [
            'm1v'	=>[ 'Ø 1V 認知'					],
            'm2c'	=>[ 'Ø 2C 信頼'					],
            'm3p'	=>[ 'Ø 3P 収益'					],
            'gc'	=>[ 'Ø ジャンル・キャラ'	],
            'gw'	=>[ 'Ø ジャンル・世界観'	],
            'p'		=>[ 'Ø 演出'							],
            'pa'	=>[ 'Ø 演出・原則'				],
            'pv'	=>[ 'Ø 演出・視覚表現'		],
            'ps'	=>[ 'Ø 演出・脚本'				],
        ],
    ];




    private $titile_name = //public $kxtt_title_array =[];//2023年型
    [
        'κ'			=> [ 'name' => '計画'					        , 'short' => '計画'	],
        'Β'			=> [ 'name' => '教訓'					        , 'short' => '教訓'	],
        'γ'			=> [ 'name' => '感性'					        , 'short' => '感性'	],
        'σ'			=> [ 'name' => '研究'					        , 'short' => '研究'	],
        'δ'			=> [ 'name' => '資料'					        , 'short' => '資料'	],
        'Μ'			=> [ 'name' => '手引'					        , 'short' => '手引'	],
        'λ'			=> [ 'name' => 'SYSTEM'				        , 'short' => 'System'	],
        '∮'			=> [ 'name' => 'Idea'					        , 'short' => 'Idea'	],

        '∫'			=>
        [
            'name'  => '制作',
            'short' => '制作',
            1 =>
            [
                'M' => 'サンプリング',
                'T' => '試作（参考）',
                'S' => '制作',
                'Y' => '試作',
                'X' => '実験作',
            ],
        ],

        '∬00'	  => [ 'name' => '（Format）'           , 'short' => '∬0'	],
        '∬01'	  => [ 'name' => '（死学）'             , 'short' => '∬1'	],
        '∬02'	  => [ 'name' => '（緋乃日和）'         , 'short' => '∬2'	],
        '∬03'	  => [ 'name' => '（思想犯）'	          , 'short' => '∬3'	],
        '∬04'		=> [ 'name' => '（思想犯D）'         , 'short' => '∬4'	],
        '∬05'	  => [ 'name' => '（224）'					    , 'short' => '∬5'	],
        '∬06'	  => [ 'name' => '（思想犯E）'			    , 'short' => '∬6'	],
        '∬07'	  => [ 'name' => '（世界観・総合）'     , 'short' => '∬7'	],
        '∬08'	  => [ 'name' => '（SoA）'					    , 'short' => '∬8'	],
        '∬09'		=> [ 'name' => '（奴隷商人zero）'			, 'short' => '∬9'	],
        '∬10'		=> [ 'name' => '（奴隷商人）'         , 'short' => 'X'	],
        '∬11'		=> [ 'name' => '（思想犯統合）'			  , 'short' => '∬11'	],
        '∬12'		=> [ 'name' => '（世界観・総合2013）' , 'short' => '∬12'	],
        '∬13'		=> [ 'name' => '（W13）'	            , 'short' => 'W13'	],
        '∬14'		=> [ 'name' => '（DELTA）'			      , 'short' => '∬14'	],
        '∬15'		=> [ 'name' => 'Olf：短編1'				      , 'short' => 'O短1'	],
        'xxx'		 => [ 'name' => 'xxx'				           , 'short' => 'xxx'	],
    ];




    //public $kxst_raretu_wwr_time_table  =
    private $title_raretu_wwr_time_table =
    [
        '∬10_800' =>
        [
            'add_code' => //全表示。
            [
                '800' =>
                [
                    '010800101',
                ],

                /*

                '001' =>
                [
                    '_s'      => '_s010800101,_s010800102,_s010800103,_s010800104,_s010800901',
                ],

                '390' =>
                [
                    '_s'      => '_s010800101,_s010800102,_s010800103,_s010800104,_s010800901',
                ],

                '4101' =>
                [
                    '_s'      => '_s010800201,_s010800302',
                ],

                '4102' =>
                [
                    '_s'      => '_s010800201',
                ],

                '6701' =>
                [
                    '_s'      => '_s010800300',
                ],

                '8a30' =>
                [
                    '_s'      => '_s010800201',
                ],

                '8a30' =>
                [
                    '_s'      => '_s010800300',
                ],

                '8a31' =>
                [
                    '_s'      => '_s010800302',
                ],

                '8c200' =>
                [
                    '_s'      => '_s010800111',
                ],
                */

            ],


            'MissingCodes_ToMainTermTable'=> //日付動機。c800以外。2024-06-22
            [

                '800' =>
                [
                    //'8c200' => '_s010800111', //TEST。2024-06-22
                ],

                /*

                '013' =>
                [
                    '800' => '_s010800102',
                ],

                '390' =>
                [
                    '800' => '_s010800102',
                ],

                '4101' =>
                [
                    '800' => '_s010800302',
                ],

                '6701' =>
                [
                    '800' => '_s010800300',
                ],

                '8a30' =>
                [
                    '800' => '_s010800300',
                ],

                '8a31' =>
                [
                    '800' => '_s010800300,_s010800302',
                ],

                '8c200' =>
                [
                    '800' => '_s010800102',
                ],
                */
            ],


            'add_code0' =>
            [
                'c800' =>
                [
                    'tag_add' => '',
                    'search'  => '∬10≫c800≫来歴≫',
                    '_s'      => '_s010800101',
                ],

                'c001_101' =>
                [
                    'tag_add' => 'c001',
                    'search'  => '∬10≫c001≫＼c800≫来歴≫',
                    '_s'      => '_s010800101',
                ],
                'c001_102' =>
                [
                    'tag_add' => 'c001',
                    'search'  => '∬10≫c001≫＼c800≫来歴≫',
                    '_s'      => '_s010800102',
                ],
                'c001_103' =>
                [
                    'tag_add' => 'c001',
                    'search'  => '∬10≫c001≫＼c800≫来歴≫',
                    '_s'      => '_s010800103',
                ],
                'c001_104' =>
                [
                    'tag_add' => 'c001',
                    'search'  => '∬10≫c001≫＼c800≫来歴≫',
                    '_s'      => '_s010800104',
                ],
                'c001_901' =>
                [
                    'tag_add' => 'c001',
                    'search'  => '∬10≫c001≫＼c800≫来歴≫',
                    '_s'      => '_s010800901',
                ],


                'c013_102' =>
                [
                    'tag_add' => 'c013',
                    'search'  => '∬10≫c013≫＼c800≫来歴≫',
                    '_s'      => '_s010800102',
                ],

                'c390_101' =>
                [
                    'tag_add' => 'c390',
                    'search'  => '∬10≫c390≫＼c800≫来歴≫',
                    '_s'      => '_s010800101',
                ],
                'c390_102' =>
                [
                    'tag_add' => 'c390',
                    'search'  => '∬10≫c390≫＼c800≫来歴≫',
                    '_s'      => '_s010800102',
                ],
                'c390_103' =>
                [
                    'tag_add' => 'c390',
                    'search'  => '∬10≫c390≫＼c800≫来歴≫',
                    '_s'      => '_s010800103',
                ],
                'c390_104' =>
                [
                    'tag_add' => 'c390',
                    'search'  => '∬10≫c390≫＼c800≫来歴≫',
                    '_s'      => '_s010800104',
                ],
                'c390_901' =>
                [
                    'tag_add' => 'c390',
                    'search'  => '∬10≫c390≫＼c800≫来歴≫',
                    '_s'      => '_s010800901',
                ],


                'c4101_201' =>
                [
                    'tag_add' => 'c4101',
                    'search'  => '∬10≫c4101≫＼c800≫来歴≫',
                    '_s'      => '_s010800201',
                ],

                'c4102_201' =>
                [
                    'tag_add' => 'c4102',
                    'search'  => '∬10≫c4102≫＼c800≫来歴≫',
                    '_s'      => '_s010800201',
                ],

                'c6701_300' =>
                [
                    'tag_add' => 'c6701',
                    'search'  => '∬10≫c6701≫＼c800≫来歴≫',
                    '_s'      => '_s010800300',
                ],
                'c6701_301' =>
                [
                    'tag_add' => 'c6701',
                    'search'  => '∬10≫c6701≫＼c800≫来歴≫',
                    '_s'      => '_s010800301',
                ],

                'c6a701_301' =>
                [
                    'tag_add' => 'c6a701',
                    'search'  => '∬10≫c6a701≫＼c800≫来歴≫',
                    '_s'      => '_s010800301',
                ],

                'c8a20_101' =>
                [
                    'tag_add' => 'c8a20',
                    'search'  => '∬10≫c8a20≫＼c800≫来歴≫',
                    '_s'      => '_s010800101',
                ],
                'c8a20_104' =>
                [
                    'tag_add' => 'c8a20',
                    'search'  => '∬10≫c8a20≫＼c800≫来歴≫',
                    '_s'      => '_s010800104',
                ],
                'c8a20_201' =>
                [
                    'tag_add' => 'c8a20',
                    'search'  => '∬10≫c8a20≫＼c800≫来歴≫',
                    '_s'      => '_s010800201',
                ],


                'c8a30_101' =>
                [
                    'tag_add' => 'c8a30',
                    'search'  => '∬10≫c8a30≫＼c800≫来歴≫',
                    '_s'      => '_s010800101',
                ],
                'c8a30_103' =>
                [
                    'tag_add' => 'c8a30',
                    'search'  => '∬10≫c8a30≫＼c800≫来歴≫',
                    '_s'      => '_s010800103',
                ],
                'c8a30_104' =>
                [
                    'tag_add' => 'c8a30',
                    'search'  => '∬10≫c8a30≫＼c800≫来歴≫',
                    '_s'      => '_s010800104',
                ],
                'c8a30_300' =>
                [
                    'tag_add' => 'c8a30',
                    'search'  => '∬10≫c8a30≫＼c800≫来歴≫',
                    '_s'      => '_s010800300',
                ],
                'c8a30_311' =>
                [
                    'tag_add' => 'c8a30',
                    'search'  => '∬10≫c8a30≫＼c800≫来歴≫',
                    '_s'      => '_s010800311',
                ],

                'c8a31_103' =>
                [
                    'tag_add' => 'c8a31',
                    'search'  => '∬10≫c8a31≫＼c800≫来歴≫',
                    '_s'      => '_s010800103',
                ],
                'c8a31_311' =>
                [
                    'tag_add' => 'c8a31',
                    'search'  => '∬10≫c8a31≫＼c800≫来歴≫',
                    '_s'      => '_s010800311',
                ],

                'c8a32_311' =>
                [
                    'tag_add' => 'c8a32',
                    'search'  => '∬10≫c8a32≫＼c800≫来歴≫',
                    '_s'      => '_s010800311',
                ],


                'c8c200_102' =>
                [
                    'tag_add' => 'c8c200',
                    'search'  => '∬10≫c8c200≫＼c800≫来歴≫',
                    '_s'      => '_s010800102',
                ],
                'c8c200_111' =>
                [
                    'tag_add' => 'c8c200',
                    'search'  => '∬10≫c8c200≫＼c800≫来歴≫',
                    '_s'      => '_s010800111',
                ],

                'c989_901' =>
                [
                    'tag_add' => 'c989',
                    'search'  => '∬10≫c989≫＼c800≫来歴≫',
                    '_s'      => '_s010800901',
                ],

            ],

            'delete_chara_code0' =>//3
            [
                [
                    'tag_not' => 'c8a30,c8a20,c390,c001',
                    'search'  => '_s010800101',
                ],

                [
                    'tag_not' => 'c8a30,c8a31,c6701',
                    'search'  => '_s010800300',
                ],

                [
                    'tag_not' => 'c8a30,c8a31,c8a32',
                    'search'  => '_s010800311',
                ],
            ],

            'MissingCodes_ToMainTermTable0' => //4
            [

                '103_c001_c800' =>
                [
                    'tag'      => 'c001',
                    'search'   => '≫＼c800≫来歴≫',
                    'main_tag' => 'c800',
                    'main_s'   => '≫c800≫来歴≫',
                    'to'       => '_s010800103',
                ],

                '103_c390_c001' =>
                [
                    'tag'     => 'c390',
                    'search'  => '≫＼c800≫来歴≫',
                    'main_tag'=> 'c001',
                    'main_s'  => 'c001≫＼c800≫来歴≫',
                    'to'      => '_s010800103',
                ],
                '103_c390_c800' =>
                [
                    'tag'      => 'c390',
                    'search'   => '≫＼c800≫来歴≫',
                    'main_tag' => 'c800',
                    'main_s'   => '≫c800≫来歴≫',
                    'to'       => '_s010800103',
                ],

                '103_c8a30_c800' =>
                [
                    'tag'      => 'c8a30',
                    'search'   => '≫＼c800≫来歴≫',
                    'main_tag' => 'c800',
                    'main_s'   => '≫c800≫来歴≫',
                    'to'       => '_s010800103',
                ],

                '103_c8a31_c800' =>
                [
                    'tag'      => 'c8a31',
                    'search'   => '≫＼c800≫来歴≫',
                    'main_tag' => 'c800',
                    'main_s'   => '≫c800≫来歴≫',
                    'to'       => '_s010800103',
                ],


                '104_c001_c800' =>
                [
                    'tag'      => 'c001',
                    'search'   => '≫＼c800≫来歴≫',
                    'main_tag' => 'c800',
                    'main_s'   => '≫c800≫来歴≫',
                    'to'       => '_s010800104',
                ],
                '104_c390_c800' =>
                [
                    'tag'      => 'c390',
                    'search'   => '≫＼c800≫来歴≫',
                    'main_tag' => 'c800',
                    'main_s'   => '≫c800≫来歴≫',
                    'to'       => '_s010800104',
                ],
                '104_c8a20_c800' =>
                [
                    'tag'      => 'c8a20',
                    'search'   => '≫＼c800≫来歴≫',
                    'main_tag' => 'c800',
                    'main_s'   => '≫c800≫来歴≫',
                    'to'       => '_s010800104',
                ],
                '104_c8a30_c800' =>
                [
                    'tag'      => 'c8a30',
                    'search'   => '≫＼c800≫来歴≫',
                    'main_tag' => 'c800',
                    'main_s'   => '≫c800≫来歴≫',
                    'to'       => '_s010800104',
                ],

            ],
        ],
    ];





    private $add_save_title = //保存介入。タイトル。KxSu::get('add_save_title')
    [
        '/' => '❗／❓' ,
        //'-' => '❗－❓' ,
        '（' => '【' ,
        '）' => '】' ,
        '(' => '〈' ,
        ')' => '〉' ,
        '+' => '＋' ,
    ];

    private $add_save_conent = //保存介入系の置換。		//public $insert_post_data_content    =
    [
        //'検索文字'	=>[ '置換タイプ'	, '置換文字' 				],	//説明

        '/\d{4}(-|_)\d{2}(-|_)\d{2}＠＠ｔ/'		=>[ 'date'	, 'Y_m_d' 				],		//タイムスタンプ
        '/＠＠ｔ/'														=>[ 'date'	, 'Y_m_d' 				],		//タイムスタンプ

        //'/＠＠ｈ/'													=>[ 'date'	, 'Y_m_d_H:i:s' 	],		//タイムスタンプ


        //'/:－＿/'                           =>[ ''			 , '－＿' 				 	],		 //LLM

        //'/:?-+\s?\|/'                            =>[ ''			 , '－＿|' 				 	],		 //LLM
        //'/---/'															  =>[ ''			 , '__＿' 				 	],		 //LLM
        //'/\n- /'														  =>[ ''			 , "\n・" 				 	],		 //LLM
        //'/\n  \- /'													  =>[ ''			 , "\n・・" 				 	],		 //LLM
        //'/\n   \- /'												  =>[ ''			 , "\n・" 				 	],		 //LLM

        '/(?<!『)≫(?!』)/'																 =>[ ''			 , '＞' 				 	],		 //特殊文字
        //'/style(.*?)"font\-family(.*?)"/'   =>[ ''	    , '' ],	//削除
        '/<p><\/p>/'											    =>[ ''	    , '' ],	//削除
        '/\n　/' 															=> "\n",
    ];



    //KxSu::get('outline_text')
    //str置換に変更可能。2025-04-08
    private $outline_text = //public $kxst_chage_text = //テキスト置換系の統合
    [
        '▲' => '<span style="color:red;">▲</span>',
        '■' => '<span style="color:Blue;">■</span>',
        '☓' => '<span style="color:yellow;">✕</span>',
    ];




    //public $raretu = //* 羅列表示順位。* 上が優先
    //KxSu::get('raretu')
    private $raretu =
    [
        // outline 着色。
        'outline_color' => '/★|▼/',

        //追記要素
        'order_add' =>
        [
            '/^γ≫芸術・作品/'	=> [ '期待,好,嫌,既存,描きたい,' , ''],
            '/^γ≫芸術・制作/'	=> [ '描きたい,' , ''],
        ],


        'order_type' =>
        [
            'set_nation' => [ '政治,経済,歴史','その他']
        ],


        'order' =>
        [
            '/^Μ≫作家要素≫創作意欲$/'	 	  					 			=> ['創作意欲,楽しさ' , ''],
            '/^Μ≫作家要素$/' 												 			 => ['感性,創作意欲' , ''],
            '/^Μ$/' 																				=> ['作家哲学,作家方針群,作家要素,AI駆動,企,小説,脚,絵,視覚,表,漫' , ''],


            '/^κ≫制作≫登場人物$/'     										=>  [ '主人公,ヒロイン,サブヒロイン,敵' , '' ],
            '/^κ≫制作$/'                                  =>  [ '全体,準備,企画,登場人物,脚本,視覚表現,各種パターン,文章' , 'その他' ],

            '/^κ≫販売戦略≫作家要素≫作家能力最大化/'      =>  [ '' , '補足,旧型' ],
            '/^κ≫販売戦略$/'  													   =>  [ '方針群' , 'アイデア,その他,関連'],
            '/^κ$/'                                         =>  [ '創作,販売,作品,制作,環境,調整' , 'MEMO,〇' ],


            '/^(Β|γ|σ|δ)≫社会科学≫経済学≫マーケティング$/' => [ 'VCP,各,方針群,作家,自,市,消,同,プロモ,集客,訴求,リピーター,話題性,商品価値,市場,消費者,独自性' , 'その他'],

            '/^(Β|γ|σ|δ)≫芸術・制作$/'                  =>[ '総括：,長所,短所,問題点,失敗,読者リアクション,売れた,売れな,市場,戦略,企,題,登場,物語,視覚,文章,演出,演技,分析,管理,資料,環' , '用語,その他'],
            '/^(Β|γ|σ|δ)≫芸術・制作/'                   =>[ '総括：' , '用語,その他'],  //上が優先
            '/^(Β|γ|σ|δ)≫芸術・制作≫視覚表現$/'        =>[ '総括：,長所,短所,問題点,失敗,読者リアクション,売れた,売れな,技法,登場人物,キャラクター,人物,ファッション,デザイン,構図,表紙,一枚絵,漫画,線画,ペン,CG' , '用語,その他'],
            '/^(Β|γ|σ|δ)≫芸術・(制作|作品)≫登場人物$/' =>[ '分類,目的,試練,相克,心理,配役,属性,既存,主,ヒーロー,ヒロイン,アンチヒーロー,少,女,男' , '' ],
            '/^(Β|γ|σ|δ)≫芸術・(制作|作品)≫登場人物≫役割/'    =>  [ '一,二,三,四,五,六,七,八,主,ヒー,ヒロイン,サブ,進,敵,アン' , '' ],
            //'/^(Β|γ|σ|δ)≫芸術・作品≫登場人物$/'        =>  [ '配役,属性,既存,主,アンチヒーロー,少,女,男' , '' ],


            '/^(Β|γ|σ|δ)≫芸術・(制作|作品)≫分類≫形式$|∮≫題材≫形式$/' //注意。共通。2021/05/08
                                                                                                            =>  [ '喜劇,悲劇,シリアス' , '' ],

            '/^(Β|γ|σ|δ)≫芸術・(制作|作品)≫分類≫登場人物$|∮≫題材≫登場人物$/'
                                                                                                            =>  [ '役割,人格,属性,能力,行動原理,背景,関係性,変化' , '' ],
            '/^(Β|γ|σ|δ)≫芸術・(制作|作品)≫分類≫登場人物≫少女≫性格・メインヒロイン$/'
                                                                                                            =>  [ '健気,恥,飄々,クール,悲壮感,M,お姫' , '' ],

            '/^(Β|γ|σ|δ)≫芸術・(制作|作品)≫分類≫登場人物≫/' =>  [ '性格・メイン,性格・サブ,性格,状況' , '' ],

            '/^(Β|γ|σ|δ)≫芸術・(制作|作品)≫分類$/'            =>  [ '世界,舞台,登場人物,形式,人間関係,状況,ルール,タグ' , '' ],

            '/^(Β|γ|σ|δ)≫芸術・作品≫登場人物≫属性$/'
                                                                                                            =>  [ 'ハードボイルド,アウトロー,クール' , '資料,その他' ],
            '/^(Β|γ|σ|δ)≫芸術・作品≫登場人物≫配役$/'  =>  [ '主,進行,二枚目,三枚目,サブ,四枚目,敵,' , '資料,その他' ],
            '/^(Β|γ|σ|δ)≫芸術・作品≫登場人物≫配役≫敵役$/'
                                                                                                            =>[ '五,六,七' , '資料,その他' ],

            '/^(Β|γ|σ|δ)≫芸術・作品$/'                  =>[ '分,登場人物,アニメ,漫,同,絵,デザ,写,文,映,ドラマ,演劇,TV,ゲ,音,芸,人物,表,題,脚本,物,詳' , 'list'],//listは小文字始まり。2023-03-01

            '/^(Β|γ|σ|δ)≫芸術・作品/'                   =>[ '登場人物,世界観,設定,TV,劇場,人物' , ''],  //上が優先



            '/^(Β|γ|σ|δ)≫医学≫心理学≫心理学理論≫ゲーム理論/'     =>[ '進化,シグ,ナッ,囚人,チキ,バン,先行,ミニマ,限界効,ゼロサ,パレー' , '参考'],
            '/^(Β|γ|σ|δ)≫医学≫心理学/'							   =>[ '基礎,社会,発達,パーソ,臨床,応用,心理学理論' , 'その他'],


            //'/^(Β|γ|σ|δ)≫人物/'                         =>  [ '' , '史上,外国人,その他'],  //上が優先

            //上が優先
            '/^(Β|γ|σ|δ)≫国・地域≫.*行政≫軍事/'       =>[ '国,陸,海軍,海自,空,海兵' , '' ],
            '/^(Β|γ|σ|δ)≫国・地域≫.*行政≫/'           =>[ '活,組' , '' ],
            '/^(Β|γ|σ|δ)≫国・地域≫/'                   =>[ '歴,政,行,治,軍,情,国際,経' , '' ],

            '/^(Β|γ|σ|δ)≫軍事学$/'                    	=> [ '軍,特,情,戦争,紛争' , 'その他,List' ],


            '/^(Β|γ|σ|δ)$/'                              => [ '社,自,人文,医,工,軍,国,人間,人物,芸術'  , 'その他,一覧,list,◆'  ],
            '/^(Β|γ|σ|δ)/'                               => [ '総括：,作業感,問題点,好,嫌'  , 'その他,一覧,List,◆'  ],


            //'/検索タイトル/'                               => [ 'j'   ,   'je'    ],

            '/∬10≫1構成≫設定≫登場人物$/'		                  => [ '対立,Σ,敵,警察,軍需,人類淘汰,中立,治安,ブルー' , '' ],


            '/^∬\d{1,}≫0構成≫題材$/'		                  => [ '共通,Ksy,Ygs' , '' ],
            '/^(∬\d{1,}≫0構成≫(構成)|∮≫制作要素≫Y\d{1,}|∮≫制作作業)/'
                                                                                                            => [ 'S,商品,マーケティング,計画,設計,題材,世界観,構成,脚本,進行,キャラ,味方,敵,設定,演出,視覚' , '感性,関連,Idea,アイデア,作業' ],

            '/^∬\d{1,}≫0構成≫設定≫登場人物$/'            => [ '協力,対立' , '補足,その他' ],
            '/^∬\d{1,}≫0構成≫/'			                      => [ '設計,構想,共通,Ksy,Ygs,Olf,構成,物語,設定,脚本,キャラ,舞台' , 'Idea,アイデア,その他' ],
            '/^∬\d{1,}≫0構成$/'						                 => [ '概要,設計,商品構成,構成：共通,構成：,構成,題材,設定,広報,Ksy,Ygs' , 'Idea,アイデア,その他,一覧' ],

            '/^∬(\d{1,})≫c(\d\w{1,}\d)≫((ksy|olf|ygs|pnm|sys)(\d{1,}))/i'
                                                                                            => [ '概要,設計' , '来歴' ],

            '/^∬\d{1,}≫c\w{1,}≫.*補足$/'		              => [ '統合系,統合部品,Prompt' , 'LLM・問答,Ver管理' ],


            '/^∬\d{1,}≫c\w{1,}.*≫(Main|2構成|＼|c\d{1}\w{1,}\d{1})$/'
                                                                                                        => [ '概要,設計,主感情,Ksy,Ygs,Olf,進行,筋書,各話' , 'Idea,アイデア,その他' ],
            '/^∬\d{1,}≫c\d\w{1,}\d$/'
                                                                                                        => [ 'UtilityFunction,Main,概要,基本設定' , 'Idea,アイデア,その他,関連' ],


            '/^∫≫(S|X|Y|T)≫\w{1,}$/'                      => [ '企画,設定,登場人物,物語,脚本,生活' , 'Idea,Memo,memo,その他' ],
            '/^∫≫(S|X|Y|T)≫\w{1,}/'                       => [ '設定,生活' , 'Idea,Memo,memo,その他,' ],
            '/^∫≫X$/'																			 => [ '登場人物,状況,構成' , '旧ナンバー,その他,' ],
            '/^∫≫X/'																			 => [ '' , 'ボツ' ],
            '/^∫$/'                                         => [ 'W,S,Y,X,M,T,登,設,ホ' , '' ],
            '/^∫/'                                          => [ '' , '試作,記録,参考,旧,その他' ],

            '/^∮≫制作作業≫\w{1,}≫LLM.*(Ksy|Ygs)$/'       => [ 'C0,C10x,C2xx,C,主人公,ヒロイン,敵,キャラ,題材,状況,構成' , '確認完了,ボツ' ],
            '/^∮≫登場人物$/'   => [ '分類,少女,ヒーロー,人格,能力,人間関係,状況,演出' , 'その他' ],
            '/^∮≫登場人物/'    => [ 'ヒロイン,ポジション,目的,Character,状況,壊,Sex' , '企画,その他' ],
            '/^∮≫/'          => [ '共通,Ksy,Ygs' , '終,その他' ],
            '/^∮$/'           => [ 'Pickup,企画,形式,登場人物,キャラ・主人公,キャラ・少女,キャラ・属性,キャラ・分類,人間関係,人名,世界観,舞台,設定,状況,脚,言' , '参,フ,素,制作,S,そ' ],
        ],//上が優先
    ];


    /*
    //* 正規表現置換。￥は除外
    //* 現在不使用。ただしリストとして残す。2025-04-08
    public $regular_expression =
    [
        '*'	=> '\*',
        '+'	=> '\+',
        '.'	=> '\.',
        '?'	=> '\?',
        '{'	=> '\{',
        '}'	=> '\}',
        '('	=> '\(',
        ')'	=> '\)',
        '['	=> '\[',
        ']'	=> '\]',
        '^'	=> '\^',
        '$'	=> '\$',
        '-'	=> '\-',
        '|'	=> '\|',
        '/'	=> '\/',
    ];
    */


    private function __construct() {
        self::$settings =
        [
            'on_off' => $this->on_off,
            'display_colors_css' => $this->display_colors_css,
            'export_text' => $this->export_text,
            //'export_text_set' => $this->export_text_set,
            'post_id' => $this->post_id,
            'base_preg' => $this->base_preg,
            'DBshare_title1_column' => $this->DBshare_title1_column,
            'DBshare_column_name' => $this->DBshare_column_name,
            'DBjson_pickup' => $this->DBjson_pickup,
            'title_array' => $this->title_array,
            'title_preg' => $this->title_preg,
            'titile_search' => $this->titile_search,
            'title_head' => $this->title_head,
            'title_kx10' => $this->title_kx10,
            'title_kx30' => $this->title_kx30,
            'titile_name' => $this->titile_name,
            'title_raretu_wwr_time_table' => $this->title_raretu_wwr_time_table,
            'add_save_title' => $this->add_save_title,
            'add_save_conent' => $this->add_save_conent,
            'outline_text' => $this->outline_text,
            'raretu' => $this->raretu,
        ];
    }



    // 自動初期化メソッド
    // このメソッドは、クラスの static プロパティ（$settingsなど）を使う前に
    // 必要な初期化（＝new して __construct を実行）を一度だけ行うためのもの
    private static function init() {

        // まだインスタンスが作られていない場合（最初の呼び出し時のみ）
        if (self::$instance === null) {

            // このクラス自身の新しいインスタンスを作成
            // ここで __construct() が実行され、設定配列が初期化される
            self::$instance = new self();

            // JSON ファイルの読み込み
            self::kxsu_loadJsonData('characters', get_stylesheet_directory() . "/data/json/chara.json");
            self::kxsu_loadJsonData('sakuhin'   , get_stylesheet_directory() . "/data/json/sakuhin.json");
            self::kxsu_loadJsonData('world'     , get_stylesheet_directory() . "/data/json/world.json");
        }


        //パスゲット。2026-01-04
        $json_path = get_stylesheet_directory() . '/data/json/paths.json';

        if (file_exists($json_path)) {
            $data = json_decode(file_get_contents($json_path), true);

            // BASE_DIR などの動的置換
            $base_dir = get_stylesheet_directory();
            self::$paths = array_map(function($path) use ($base_dir) {
                return str_replace('BASE_DIR', $base_dir, $path);
            }, $data);
        }



    }



    /**
     * Undocumented function
     *
     * @param [type] $key
     * @return void
     */
    public static function get($key) {
        self::init(); // ← ここで初期化してから取り出す
        return self::$settings[$key] ?? '';
    }




    /**
     * JSONファイルを読み込み設定に統合する共通メソッド
     *
     * @param string $key 設定キー (例: 'characters')
     * @param string $filePath JSONファイルのパス
     */
    private static function kxsu_loadJsonData($key, $filePath) {
        if (file_exists($filePath))
        {
            $data = kx_json_arr($filePath);

            // データが配列の場合のみ設定に統合
            if (is_array($data))
            {
                self::$settings['configs'][$key] = $data;
            } else {
                // JSONデコードエラーハンドリング
                error_log("JSON デコードに失敗しました: " . $filePath);
            }
        }
        else
        {
            // ファイルが見つからない場合のエラーハンドリング
            error_log("JSON ファイルが見つかりません: " . $filePath);
        }
    }

    /**
         * 指定したキーのパスを取得
         */
        public static function get_path($key, $default = '') {
            return self::$paths[$key] ?? $default;
        }





}//********** ********** ********** kxSu ********** ********** **********




/**
 * 設定クラス。旧。
 * 2025-04-07
 */
/*
class Kxst{
//切り替え n:ノーマル / d:ダーク
//public $css_color_type = 'd';

//設定基本検索
/*
public $work_list =
[
	'Json_ST_type' =>
	[
		'タグ',
	],

	'Json_Pickup_link' =>
	[
		'シリーズ',
		'スタジオ',
		'監督',
		'原作者',
		'脚本',
		'演出',
		'キャラクター原案',
		'キャラクターデザイン',
		'音楽',
		'キャラ',
		'属性',
		'ジャンル',
		'評価',
	],
];
*/
//} //class。2023-03-05

// 短縮名 Su:: でアクセス可能にする
if (!class_exists('Su')) {
    class_alias(\Kx\Core\SystemConfig::class, 'Su');
}

// 既存の KxSu:: 呼び出し（1.4万件の互換性）を維持する
if (!class_exists('KxSu')) {
    class_alias(\Kx\Core\SystemConfig::class, 'KxSu');
}